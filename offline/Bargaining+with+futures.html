<!DOCTYPE html SYSTEM "about:legacy-compat">
<html manifest="pamflet.manifest">
      <head>
        <meta charset="utf-8"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>
        <title>Dispatch — Bargaining with futures</title>
        
        <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"/>
        <link rel="stylesheet" href="css/pamflet.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamflet-print.css" type="text/css" media="print"/>
        <link rel="stylesheet" href="css/pamflet-grid.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <link rel="stylesheet" href="css/color_scheme-redmond.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-github.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/color_scheme-monokai.css" type="text/css" media="screen, projection"/>
        <link rel="stylesheet" href="css/pamfletheight_2em_2em.css" type="text/css" media="screen and (min-device-width: 800px), projection"/>
        <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
        <script type="text/javascript" src="js/pamflet.js"></script>
        <script type="text/javascript">
          Pamflet.page.language = 'en';
        </script>
        <script type="text/javascript" src="js/prettify/prettify.js"></script><script type="text/javascript" src="js/prettify/lang-scala.js"></script><link type="text/css" rel="stylesheet" href="css/prettify.css"/><script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
        <link rel="stylesheet" href="css/dispatch.css" type="text/css" media="screen, projection"/>
        
        
      </head>
      <body class="color_scheme-github">
        <div class="container-fluid contentswrapper h-100">
          <div class="row minh-100">
          <div class="col-md-4 col-xl-3 toccolumn leftcolumn">
                  <div class="lefttocwrapper">
      <div class="tocwrapper">
        
        <div class="tocbody show" id="toc">
        
        <div><a href="Dispatch.html">Dispatch</a></div><ol class="toc"> <li><div class="current">Bargaining with futures</div><ol class="toc"> <li><div><a href="Abstraction+over+future+information.html">Abstraction over future information</a></div></li><li><div><a href="Working+with+multiple+futures.html">Working with multiple futures</a></div></li><li><div><a href="Arbitrarily+many+futures.html">Arbitrarily many futures</a></div></li> </ol></li><li><div><a href="A+future+of+success+and+failure.html">A future of success and failure</a></div><ol class="toc"> <li><div><a href="Success+as+the+only+option.html">Success as the only option</a></div></li><li><div><a href="Either+type+will+do.html">Either type will do</a></div></li><li><div><a href="Either+Future.html">Either Future</a></div></li> </ol></li><li><div><a href="Defining+requests.html">Defining requests</a></div><ol class="toc"> <li><div><a href="HTTP+methods+and+parameters.html">HTTP methods and parameters</a></div></li> </ol></li><li><div><a href="Unraveling+for-expressions.html">Unraveling for-expressions</a></div><ol class="toc">  </ol></li><li><div><a href="Scaladoc+Index.html">Scaladoc Index</a></div><ol class="toc">  </ol></li><li class="generated"><div><a href="Contents+in+Depth.html">Contents in Depth</a></div></li><li class="generated"><div><a href="Combined+Pages.html">Combined Pages</a></div></li> </ol></div>
      </div>
      </div>
                </div><div class="col-md-8 col-xs-9">
                  <div class="rightcolumn contents">
                  <h2 id="Bargaining+with+futures">Bargaining with futures<a href="#Bargaining+with+futures" class="header-link"><span class="header-link-content">&nbsp;</span></a></h2><p>Applying a future is like taking a hostage. Your demands might be met
in time, but until they are you’re sitting around doing nothing other
than guarding a prisoner.
</p><p>So we don’t like to take hostages or apply futures, but what good is
a future if you can’t do anything with its value? Luckily, you can do
plenty. You just have to be flexible about when things happen.
</p><h3 id="Transformations">Transformations<a href="#Transformations" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>A future is like an option that doesn’t know what it is yet; that
doesn’t stop it from transforming into something else. We could
transform an option of a string into an option of its length. Same
goes for futures.
</p><pre><code class="prettyprint lang-scala">import dispatch._, Defaults._
val svc = url(&quot;http://api.hostip.info/country.php&quot;)
val country = Http.default(svc OK as.String)
val length = for (c &lt;- country) yield c.length
</code></pre><p>The <code>length</code> value is a future of integer.
</p><h3 id="Future%23print">Future#print<a href="#Future%23print" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>If you pasted the above into a console, you probably saw something
like this in the output:
</p><pre><code>country: scala.concurrent.Future[String] =
  scala.concurrent.impl.Promise$DefaultPromise@4929b5a5
length: scala.concurrent.Future[Int] =
  scala.concurrent.impl.Promise$DefaultPromise@581fa0fe
</code></pre><p>Not too helpful right? The <code>print</code> method makes a nicer string:
</p><pre><code>scala&gt; country.print
res0: String = Future(US)
</code></pre><p>If the future value isn’t available, <code>print</code> won’t wait:
</p><pre><code>scala&gt; Http.default(svc OK as.String).print
res1: String = Future(-incomplete-)
</code></pre><blockquote><p><strong>Note:</strong> <code>print</code> and some other <code>Future</code> methods in this documentation
  are provided implicitly by <code>dispatch.EnrichedFuture</code>
</p></blockquote><h3 id="Future%23completeOption">Future#completeOption<a href="#Future%23completeOption" class="header-link"><span class="header-link-content">&nbsp;</span></a></h3><p>How does <code>print</code> work on unknown values? It uses an option. You can
use the same technique to access the integer value, <em>if it’s
available</em>.
</p><pre><code class="prettyprint lang-scala">val lengthNow = length.completeOption.getOrElse(-1)
</code></pre><p>But most of the time, you want to operate on values that are known to
be available. In the next pages we’ll see how far we can go in this
direction by transforming futures.
</p><div class="bottom nav">
                <div class="row">
                  <div class="col-md-auto">
                    <a href="Abstraction+over+future+information.html">
                      <div class="arrowitem">
                        <span class="arrow">&gt;</span>
                      </div>

                      <div class="arrowitem">
                        <em>Next page</em><br/>
                        Abstraction over future information
                      </div>

                    </a>
                  </div>
                </div>
                
              </div>
                  </div>
                </div>
          </div> <!-- row -->
        </div>
        <div class="header">
          <div class="container-fluid top nav">
        <div class="row justify-content-md-center w-100">
          <div class="col-md-auto">
            <div class="title">
              <span>Dispatch</span> — Bargaining with futures
            </div>
          </div>
        </div>
      </div>
        </div>
        <div class="footer">
          
        </div>
        <a href="http://github.com/dispatch/reboot" class="fork nav"><img src="img/fork.png" alt="Fork me on GitHub"/></a>
        
      </body>
    </html>